# Инструкция по обновлению для функции профиля и аватара

## Обновление базы данных

Если база данных уже создана, выполните SQL-скрипт для добавления поля `avatar`:

### Вариант 1: Через phpMyAdmin
1. Откройте phpMyAdmin
2. Выберите базу данных `korochnik`
3. Перейдите на вкладку **SQL**
4. Выполните следующий запрос:

```sql
ALTER TABLE users 
ADD COLUMN avatar VARCHAR(255) DEFAULT NULL AFTER email;

ALTER TABLE users 
ADD COLUMN updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP AFTER created_at;
```

### Вариант 2: Через командную строку
```bash
mysql -u root -p korochnik < backend/update_users_table.sql
```

## Создание папки для аватаров

Папка `backend/uploads/avatars/` будет создана автоматически при первой загрузке аватара.

Если нужно создать вручную:
1. Создайте папку `backend/uploads/avatars/`
2. Установите права на запись (chmod 777 для тестирования)

## Проверка работы

1. Войдите в систему как пользователь
2. Перейдите в личный кабинет
3. Нажмите "Редактировать профиль"
4. Загрузите аватар (JPEG, PNG, GIF или WebP, максимум 5MB)
5. Измените данные профиля (ФИО, телефон, email)
6. Сохраните изменения
7. Проверьте, что аватар отображается в шапке сайта

## Решение проблем

### Аватар не загружается
- Проверьте права на папку `backend/uploads/avatars/` (должны быть права на запись)
- Проверьте, что поле `avatar` добавлено в таблицу `users`
- Проверьте консоль браузера (F12) на наличие ошибок

### Аватар не отображается
- Проверьте путь к файлу в базе данных
- Убедитесь, что файл существует в папке `backend/uploads/avatars/`
- Проверьте путь к API в `frontend/app.js`

### Ошибка "Необходима авторизация"
- Убедитесь, что вы вошли в систему
- Проверьте, что сессия активна на сервере

